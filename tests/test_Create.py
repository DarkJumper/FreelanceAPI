import pytest
from freelanceapi.utils import (
    Create, create_ascii_hex, create_string_from_dict_with_list_of_dicts, create_string_from_dict_with_string
    )

from .ClassifyedExample import (example_classifyed_hw2blob, example_classifyed_msrrecord, example_classifyed_paradata)
from .ExampleRows import (example_msrrecord_row, example_paradata_row, exmaple_hw2blob_row)


def test_empty_create_string_from_dict_with_string():
    classify = Create({})
    assert classify.execute(create_string_from_dict_with_string()) == ""


def test_empty_create_string_from_dict_with_list_of_dicts():
    classify = Create({})
    assert classify.execute(create_string_from_dict_with_list_of_dicts()) == ""


def test_empty_create_ascii_hex():
    classify = Create({})
    assert classify.execute(create_ascii_hex()) == ""


def test_create_string_from_dict_with_string(example_classifyed_paradata):
    create_string = Create(example_classifyed_paradata["PARA"])
    assert create_string.execute(
        create_string_from_dict_with_list_of_dicts()
        ) == "QUIT1;11;CONFIRMFORM;1;1;QUIT2;11;CONFIRMFORM;1;1;QUIT3;11;CONFIRMFORM;1;2;QUIT4;11;CONFIRMFORM;1;2"


def test_create_string_from_dict_with_string(example_classifyed_msrrecord, example_msrrecord_row):
    create_string = Create(example_classifyed_msrrecord)
    assert create_string.execute(create_string_from_dict_with_string()) == example_msrrecord_row


def test_tuple_of_decode_ascii_code(example_classifyed_hw2blob):
    create_string = Create(example_classifyed_hw2blob["DTMC"])
    assert create_string.execute(
        create_ascii_hex()
        ) == "55006E00690074005F0044006900610067005F0042006900740028003000290020003D0020002200430049003800340030002000420020006500720072006F00720022000D000A0055006E00690074005F0044006900610067005F0042006900740028003100290020003D0020002200430049003800340030002000410020006500720072006F00720022000D000A0055006E00690074005F0044006900610067005F0042006900740028003300290020003D002000220052006500640075006E00640061006E007400200070006F007700650072002000410020004600610069006C0075007200650022000D000A0055006E00690074005F0044006900610067005F0042006900740028003400290020003D002000220052006500640075006E00640061006E007400200070006F007700650072002000420020006600610069006C0075007200650022000D000A0055006E00690074005F0044006900610067005F0042006900740028003600290020003D002000220052006500640075006E00640061006E006300790020007700610072006E0069006E00670022000D000A0055006E00690074005F0044006900610067005F0042006900740028003700290020003D0020002200530074006100740069006F006E0020007700610072006E0069006E00670022000D000A0055006E00690074005F0044006900610067005F0042006900740028003800290020003D0020002200530074006100740069006F006E002000610064006400720065007300730020007700610072006E0069006E00670022000D000A0055006E00690074005F0044006900610067005F00420069007400280031003400290020003D002000220052006500640075006E00640061006E00740020006300610062006C0065002000410020006500720072006F00720022000D000A0055006E00690074005F0044006900610067005F00420069007400280031003500290020003D002000220052006500640075006E00640061006E00740020006300610062006C0065002000420020006500720072006F00720022000D000A000000"
